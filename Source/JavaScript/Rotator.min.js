function EngageRotator(A,C,H,B,I,J,G,F){this.timerLength=A;this.pausedDelayLength=C;this.forward=true;this.timerID=null;this.millisecondsPerSecond=1000;this.isPaused=false;this.rotatorId=H;this.positionId=B;this.isPaused=false;this.animation=null;this.useAnimations=I;this.duration=J;this.fps=G;this.positionCounterId=F;EngageRotator.prototype.StopTheClock=function(){clearTimeout(this.timerID)};EngageRotator.prototype.StartTheTimer=function(){if(!this.isPaused){var L=this;var K=function(){L.DisplayArticle();L.StartTheTimer()};this.timerID=setTimeout(K,this.millisecondsPerSecond*this.timerLength)}};EngageRotator.prototype.DisplayArticle=function(M){if(this.animation==null||!this.animation.get_isPlaying()){for(i=0;i<this.articles.length;i++){var K=this.articles[i].id;var S=document.getElementById(K);if(S.style.display=="block"&&M!=i){if(M==null){M=this.GetNewPosition(i)}var L=this.articles[M].id;var N=document.getElementById(L);if(this.positions&&this.positions[i]){var Q=this.positions[i].id;var O=document.getElementById(Q);if(this.positions[M]){var P=this.positions[M].id;var T=document.getElementById(P);if(T){T.className="rotatorPositionSelected"}}if(O){O.className="rotatorPosition"}}var R=document.getElementById(this.positionCounterId);if(R){R.innerHTML=M+1}this.animation=this.switchElements(S,N);break}}}};EngageRotator.prototype.switchElements=function(K,O){if(K&&O){if(this.useAnimations){if(this.duration==null){this.duration=0.5}if(this.fps==null){this.fps=30}var L=Sys.UI.DomElement.getBounds(K);K.style.width=L.width+"px";L=EngageRotator.findPosition(K);K.style.left=L.x+"px";K.style.top=L.y+"px";K.style.position="absolute";O.style.position="";O.style.display="block";var N=[new AjaxControlToolkit.Animation.FadeOutAnimation(K,this.duration,this.fps,0,1,false),new AjaxControlToolkit.Animation.FadeInAnimation(O,this.duration,this.fps,0,1,false)];var M=new AjaxControlToolkit.Animation.ParallelAnimation(O,this.duration,this.fps,N);M.add_ended(function(){K.style.display="none"});M.play();return M}else{O.style.display="block";K.style.display="none"}}};EngageRotator.prototype.GetNewPosition=function(K){if(this.forward){var L=this.articles.length-1;if(K==L){return 0}else{return K+1}}else{if(K==0){return this.articles.length-1}else{return K-1}}};EngageRotator.prototype.Previous=function(){this.isPaused=false;this.forward=false;this.DisplayArticle();this.StopTheClock();this.StartTheTimer();this.forward=true};EngageRotator.prototype.Next=function(){this.isPaused=false;this.DisplayArticle();this.StopTheClock();this.StartTheTimer()};EngageRotator.prototype.Show=function(K){this.isPaused=false;this.DisplayArticle(K);this.StopTheClock();this.StartTheTimer()};EngageRotator.prototype.Pause=function(){this.StopTheClock();this.isPaused=true};EngageRotator.prototype.OnMouseOut=function(){if(!this.isPaused){var L=this;var K=function(){L.DisplayArticle();L.StartTheTimer()};this.timerID=setTimeout(K,this.millisecondsPerSecond*this.pausedDelayLength)}};EngageRotator.getFirstLevelChildrenElements=function(O){var M=new Array();var N=0;var L=document.getElementById(O);if(L&&L.firstChild){var K=L.firstChild;while(K){if(K.nodeType==1){M[N]=K;N=N+1}K=K.nextSibling}}return M};EngageRotator.findPosition=function(L){var K=curtop=0;if(L.offsetParent){K=L.offsetLeft;curtop=L.offsetTop;var M=EngageRotator.getStyle(L.offsetParent,"position");while(L.offsetParent&&(!M||M=="static")){L=L.offsetParent;K+=L.offsetLeft;curtop+=L.offsetTop;M=EngageRotator.getStyle(L.offsetParent,"position")}}return{"x":K,"y":curtop}};EngageRotator.getStyle=function(K,L){if(K){var M="";if(document.defaultView&&document.defaultView.getComputedStyle){M=document.defaultView.getComputedStyle(K,"").getPropertyValue(L)}else{if(K.currentStyle){L=L.replace(/\-(\w)/g,function(N,O){return O.toUpperCase()});M=K.currentStyle[L]}}return M}};this.articles=EngageRotator.getFirstLevelChildrenElements(this.rotatorId);this.positions=EngageRotator.getFirstLevelChildrenElements(this.positionId);if(this.positions&&this.positions[0]){var E=this.positions[0].id;var D=document.getElementById(E);if(D){D.className="rotatorPositionSelected"}}this.StartTheTimer()};